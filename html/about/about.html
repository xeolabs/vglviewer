<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="content-type"
 content="text/html; charset=ISO-8859-1">
  <title>Site Index</title>
  <link rel="stylesheet" type="text/css" href="stylesheet.css"
 title="Style">
</head>
<body>
<table
 style="width: 100%; background-color: rgb(204, 204, 204); font-weight: bold; font-family: helvetica,arial,sans-serif;">
  <tbody>
    <tr>
      <td class="navBack"><a onclick="javascript:history.go(-1)"
 href="javascript:history.go(-1)"><font class="navGlobal">&lt;&lt; Back</font></a></td>
    </tr>
  </tbody>
</table>
<div style="text-align: center;"><span
 style="font-family: helvetica,arial,sans-serif;"></span><big
 style="font-family: helvetica,arial,sans-serif;"><big><big><big><br>
SiteGen V1.0</big></big></big></big><br>
</div>
<font class="pageTitle"></font>
<div style="text-align: center;"><small><span
 style="font-family: helvetica,arial,sans-serif;"><br>
Lindsay Kay, August 4, 2004<br>
<br>
</span></small>
<div style="text-align: left;"><small><span
 style="font-family: helvetica,arial,sans-serif;">This website was
generated automatically by a Java program named SiteGen, which I wrote
on August 4th, 2004 to help document my COSC427 (Object-Oriented
Software Architecture) assignment. This page describes the format of
the
content files from which SiteGen generates a website, as well as the
architecture of the SiteGen program itself.<br>
<br>
</span></small></div>
<div style="text-align: left;"><small style="font-style: italic;"><span
 style="font-family: helvetica,arial,sans-serif;">C</span><span
 style="font-family: helvetica,arial,sans-serif;">ontents:<br>
</span></small></div>
<small><span style="font-family: helvetica,arial,sans-serif;"></span></small></div>
<div style="margin-left: 40px;"><small><span
 style="font-family: helvetica,arial,sans-serif;"></span></small><br>
<small><span style="font-family: helvetica,arial,sans-serif;"><a
 href="#Content_Files_for_SiteGen">1. Content Files for SiteGen</a></span></small><br>
<small><span style="font-family: helvetica,arial,sans-serif;"><a
 href="#SiteGen_Class_Architecture">2. SiteGen Class Architecture</a></span></small><a
 href="#SiteGen_Class_Architecture"><small><span
 style="font-family: helvetica,arial,sans-serif;"></span></small><small></small></a><small><a
 href="file:///home/lindsay/testSite/about.html#SiteGen_Class_Architecture"><br>
</a></small>
<div style="margin-left: 40px;"><small><a href="#3.1_Packages_"><span
 style="font-family: helvetica,arial,sans-serif;">2.1 Packages</span></a><br>
<a href="#3.2_Document_Model"><span
 style="font-family: helvetica,arial,sans-serif;">2.2 Book Model</span></a><br>
<a href="#3.3_Document_HTML_Renderer"><span
 style="font-family: helvetica,arial,sans-serif;">2.3 Book HTML Renderer</span></a></small><br>
</div>
<small><span style="font-family: helvetica,arial,sans-serif;"></span></small></div>
<small><span style="font-family: helvetica,arial,sans-serif;"></span></small><small><br>
<br style="font-family: helvetica,arial,sans-serif;">
<big><span
 style="font-family: helvetica,arial,sans-serif; font-weight: bold;"><a
 name="Content_Files_for_SiteGen"></a>1. Content Files for SiteGen</span></big><br
 style="font-family: helvetica,arial,sans-serif;">
</small><small><span style="font-family: helvetica,arial,sans-serif;"><br>
SiteGen works by parsing a site map XML file called a "book". <br>
</span></small><br style="font-family: helvetica,arial,sans-serif;">
<small><span style="font-family: helvetica,arial,sans-serif;">The book
file describes a tree structure of pages, each of which has a title and
a description. There are two kinds of pages: Category and Article. A
Category page is a branch in the tree (or the root), with links to
sub-pages. An Article is a leaf, which can contain content such as text
and figures. </span><br
 style="font-family: helvetica,arial,sans-serif;">
<br style="font-family: helvetica,arial,sans-serif;">
<span style="font-family: helvetica,arial,sans-serif;">Here's an
example of a book file:<br>
</span></small><small><br>
<br>
</small>
<table cellpadding="6" cellspacing="0" border="1"
 style="text-align: left; width: 100%;">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 153);"><span
 style="font-family: monospace;">&lt;book&gt;</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; &lt;page
title="Dragonflies"</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; description="A book on common New Zealand
dragonflies"&gt;</span><br style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &lt;page &nbsp;title="Introduction"</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; description="Introducing common
dragonflies\"</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; article="intro.xml"</span><span
 style="font-family: monospace;">/&gt;</span><br
 style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &lt;page title="The Scarlet Damselfly"</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; description="An article on
Xanthocnemis zealandica"</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; article="scarletDamselfly.xml"</span><span
 style="font-family: monospace;">/&gt;<br>
      <br>
      </span><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &lt;page title="The Blue Damselfly"</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; description="An article on
Austrolestes colensonis"</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; article="blueDamselfly.xml"</span><span
 style="font-family: monospace;">/&gt;</span><br
 style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&lt;bibliography url="bibliography.xml"/&gt;</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&lt;/book&gt;</span></td>
    </tr>
  </tbody>
</table>
<span style="font-family: monospace;"></span><br>
<small><br>
<span style="font-family: helvetica,arial,sans-serif;">From this file
SiteGen will generate a web site with a home page entitled
"Dragonflies", which will have links to sub-pages entitled
"Introduction", "</span></small><span style="font-family: monospace;">The
Scarlet Damselfly</span><small><span
 style="font-family: helvetica,arial,sans-serif;">" and "</span></small><span
 style="font-family: monospace;">The Blue Damselfly</span><small><span
 style="font-family: helvetica,arial,sans-serif;">". Each of these
sub-pages will contain content specified by their respective "article"
files. Note also the reference to a bibliography file at the bottom of
the file, which I'll explain shortly.</span><br
 style="font-family: helvetica,arial,sans-serif;">
<br style="font-family: helvetica,arial,sans-serif;">
<span style="font-family: helvetica,arial,sans-serif;">The article file
<span style="font-style: italic;">scarletDamselfly.xml</span> for the
second
article, "The Scarlet Damselfly",&nbsp; might look like this:</span></small><small><br>
<br>
<br>
</small>
<table cellpadding="6" cellspacing="0" border="1"
 style="text-align: left; width: 100%;">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 153);"><span
 style="font-family: monospace;">&lt;article&gt;</span><br
 style="font-family: monospace;">
      <div style="margin-left: 40px; font-family: monospace;">&lt;section
title="Appearance"&gt;<br>
      </div>
      <div style="margin-left: 80px; font-family: monospace;">&lt;anchor
category="Damselflies" <br>
      <div style="margin-left: 80px;">topic="Red" <br>
context="The Scarlet Damselfly is bright red"/&gt;<br>
      </div>
      </div>
      <div style="margin-left: 80px; font-family: monospace;">&lt;para&gt;<br>
      </div>
      <div style="margin-left: 120px; font-family: monospace;">The
Scarlet Damselfly is about 1.5" long with a bright red abdomen, though
that of the females is duller and sometimes blackish-bronze.<br>
      </div>
      <div style="margin-left: 80px; font-family: monospace;">&lt;/para&gt;<br>
      </div>
      <div style="margin-left: 80px; font-family: monospace;">&lt;figure
name="scarletDamselflyPhoto" <br>
      <div style="margin-left: 80px;">url="scarletDamselfly.gif" <br>
caption="Scarlet Damselfly: actual length 1.4 inches"/&gt;<br>
      </div>
      </div>
      <div style="margin-left: 80px; font-family: monospace;">&lt;para&gt;<br>
      </div>
      <div style="margin-left: 80px; font-family: monospace;">&nbsp;&nbsp;&nbsp;
The eggs are laids when the sexes are yet in tandem, and are placed in
plant tissues under water; during this operation, the female is often
completely submerged, together with most of the male.<br>
      </div>
      <div style="margin-left: 120px; font-family: monospace;">&lt;bibRef
key="MIL"/&gt;<br>
      </div>
      <div style="margin-left: 80px; font-family: monospace;">&lt;/para&gt;<br>
      </div>
      <div style="margin-left: 40px; font-family: monospace;">&lt;/section&gt;<br>
      </div>
      <span style="font-family: monospace;">&lt;/article&gt;</span><br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<small><br style="font-family: helvetica,arial,sans-serif;">
<span style="font-family: helvetica,arial,sans-serif;">From this
article file SiteGen will generate </span></small><small><span
 style="font-family: helvetica,arial,sans-serif;">an article page with
a single section containing two paragraphs and a figure, &nbsp;</span></small><small><span
 style="font-family: helvetica,arial,sans-serif;">a link to the page in
a site index, and </span></small><small><span
 style="font-family: helvetica,arial,sans-serif;">a reference to a
bibliography item.&nbsp;</span></small><small><span
 style="font-family: helvetica,arial,sans-serif;">The bibliography
file, the URL to which is specified in the book file shown earlier,
might look like this:</span></small><br>
<small> <br>
<br>
</small>
<table cellpadding="6" cellspacing="0" border="1"
 style="text-align: left; width: 100%;">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 153);"><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;">&lt;bibliography&gt;</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&lt;entry key="MIL"&nbsp; title="Common Insects in New Zealand - Divid
Miller"/&gt;</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&lt;entry key="DAV" title="Grassgrubs and their Relatives - Julie
Davies"/&gt;</span><span style="font-family: monospace;"></span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&lt;/bibliography&gt;</span><br>
      </td>
    </tr>
  </tbody>
</table>
<small><br style="font-family: helvetica,arial,sans-serif;">
<span style="font-family: helvetica,arial,sans-serif;"><br>
As you can see, the bibliography format is minimal in this version of
SiteGen and will be extended in the next version.</span><br
 style="font-family: helvetica,arial,sans-serif;">
<br style="font-family: helvetica,arial,sans-serif;">
<span style="font-family: helvetica,arial,sans-serif;">Notice the
"anchor" element in the article file above. From this element SiteGen
will generate a link within an index page, where the the link can be
clicked on to jump to the article. The anchor element specifies the
category and topic under which the link is to be listed in the index,
as well as a description of the context of the article in relation to
the category and topic. SiteGen generates a new category and topic
automatically as they are specified by anchor elements.</span><br
 style="font-family: helvetica,arial,sans-serif;">
<br>
<br>
</small><small><big><span
 style="font-family: helvetica,arial,sans-serif; font-weight: bold;"><a
 name="SiteGen_Class_Architecture"></a>2. SiteGen Class Architecture<br>
</span></big></small><br>
<small><span style="font-family: helvetica,arial,sans-serif;"><span
 style="font-weight: bold;"><a name="3.1_Packages_"></a>2.1 Packages</span><br>
<br>
</span></small><small><span
 style="font-family: helvetica,arial,sans-serif;">SiteGen consists of
two packages as shown below. Package <span style="font-style: italic;">book</span>
implements a book model, generated from content files, while <span
 style="font-style: italic;">BookHTMLRenderer</span> implements a
renderer which renders a book model to disk as HTML files.<br>
<br>
<br>
</span></small>
<table cellpadding="2" cellspacing="0" border="1"
 style="text-align: left; width: 100%; margin-left: auto; margin-right: auto; background-color: rgb(255, 255, 255);">
  <tbody>
    <tr>
      <td style="vertical-align: top; text-align: center;"><small><span
 style="font-family: helvetica,arial,sans-serif;"><br>
      <img src="packages.gif" title="SiteGen packages"
 alt="SiteGen packages" style="width: 427px; height: 813px;"><br>
      <br>
      </span></small></td>
    </tr>
  </tbody>
</table>
<small><span style="font-family: helvetica,arial,sans-serif;"></span></small><br>
<br>
<div style="text-align: left;"><small><span
 style="font-family: helvetica,arial,sans-serif;"></span></small><small><span
 style="font-family: helvetica,arial,sans-serif;"></span></small><small><span
 style="font-family: helvetica,arial,sans-serif;"><span
 style="font-weight: bold;"><a name="3.2_Document_Model"></a>2.2 Book
Model<br>
</span></span></small><br>
<small><span style="font-family: helvetica,arial,sans-serif;"></span></small></div>
<small><span style="font-family: helvetica,arial,sans-serif;">The book
model implemented in package <span style="font-style: italic;">book </span>consists
of the classes shown in the class diagram below. <br>
<br>
</span></small><small><span
 style="font-family: helvetica,arial,sans-serif;"><span
 style="font-weight: bold; font-style: italic;">Initialisation<br>
</span></span></small><br>
<small><span style="font-family: helvetica,arial,sans-serif;"> The book
model is a Composite which implements the Interpretor pattern to
initialise itself from content files. To load the book model, root
element <span style="font-style: italic;">Book</span> creates an XML
DOM
by parsing the book site map file, then as interpretation proceeds,
subtrees of the DOM are recursively passed to sub-elements to interpret
and initialise themselves from.<br>
<br>
An Article is initialised from the XML file found at the URL specified
by the <span style="font-style: italic;">article</span> attribute of a
<span style="font-style: italic;">page</span> element;&nbsp; an Article
loads
itself in the same way as a Page, where it parses an article file into
a
DOM, then initialises it's sub-elements from the DOM's subtrees.<br>
<br>
<span style="font-weight: bold; font-style: italic;">Traversal</span><br>
<br>
The book model is traversed using the Visitor pattern, where the book
model iself is responsible for the structure traversal. Each element
accepts a visitor twice during depth-first traversal; once in pre-order
(before sub-pages are visited), then a second time in post-order (after
sub-pages are visited). This is because some elements have content
enclosing that of sub-elements. For example, a Page encloses one or
more
Section elements; when rendering the book model, Page HTML header tags
would be rendered, then tags for the Sections, followed finally by Page
trailer tags.<br>
<br>
<br>
</span></small>
<table cellpadding="2" cellspacing="0" border="1"
 style="text-align: left; width: 100%;">
  <tbody>
    <tr>
      <td style="vertical-align: top;"><small><span
 style="font-family: helvetica,arial,sans-serif;"><br>
      <img src="book.gif" title="book DOM classes"
 alt="book DOM classes" style="width: 1249px; height: 1074px;"><br>
      </span></small></td>
    </tr>
  </tbody>
</table>
<small><span style="font-family: helvetica,arial,sans-serif;"><br>
<br>
The following instance diagram shows the book model objects that
SiteGen would generate from the content files shown earlier. For
clarity, only the&nbsp; "Scarlet Damselfly" Article is shown, as a
sub-element of <span style="font-style: italic;">page2. </span>Note
the Bibliography's BibEntry and the Paragraph's BibRef.<br>
<br>
</span></small><br>
<table cellpadding="2" cellspacing="0" border="1"
 style="text-align: left; width: 100%;">
  <tbody>
    <tr>
      <td style="text-align: center; vertical-align: middle;"><small><span
 style="font-family: helvetica,arial,sans-serif;"><br>
      <img src="bookInstance.gif" title="book DOM instance"
 alt="book DOM instance" style="width: 881px; height: 701px;"><br>
      </span></small></td>
    </tr>
  </tbody>
</table>
<br>
<br>
<a name="3.3_Document_HTML_Renderer"></a><small><span
 style="font-family: helvetica,arial,sans-serif;"></span></small><small><span
 style="font-family: helvetica,arial,sans-serif;"></span></small><small><span
 style="font-family: helvetica,arial,sans-serif;"><span
 style="font-weight: bold;">2.3 Book HTML Renderer<br>
</span></span></small><br>
<small><span style="font-family: helvetica,arial,sans-serif;"></span></small>
<small><span style="font-family: helvetica,arial,sans-serif;">A book
&nbsp;model is
rendered to disk as HTML pages by a BookHTMLRenderer, which visits each
element of the model in depth-first order with an
HTMLBookElementVisitor. <br>
<br>
As the HTMLBookElementVisitor traverses the book model Composite, it
will be generating mutliple HTML files concurrently whenever nested
document Page elements are being rendered. &nbsp;Consider the book
model
instance diagram above; when visiting <span style="font-style: italic;">page2,</span>
HTMLBookElementVisitor will be concurrently generating two HTML files,
for <span style="font-style: italic;">page1</span> and for sub-page <span
 style="font-style: italic;">page2</span>. &nbsp;In graph traversal
terminology, <span style="font-style: italic;">page1</span> is termed
"live", while <span style="font-style: italic;">page2 </span>is the
current node.<br>
<br style="text-decoration: underline; font-weight: bold;">
<span style="font-style: italic; font-weight: bold;">Managing the
Concurrent Generation of Multiple HTML Files</span><br>
<br>
It's not desirable to have many files open simultaneously, since the
number of open files might exceed some operating system limit.&nbsp;
Therefore, HTMLBookElementVisitor uses a PageFileStack to maintain a
stack of PageFile objects, each of which is associated with a Page and
it's corresponding HTML disk file under construction; objects inside
the
stack are for "live" pages, with the object at the top for the current
page. Only the top PageFile's file is ever open, and when the top
PageFile is popped after finishing it's file, the file for the new top
PageFile is reopened ready to be appended to. This is an example of
state management within a Visitor.<br>
<br>
<span style="font-weight: bold; font-style: italic;">Bibliography and
Index</span><br>
<br>
HTMLBookElementVisitor aggregates a BibliographyPage and a
SiteIndexPage. Each time it visits a BibRef, adds a new BibPageEntry to
the BibliographyPage. Likewise, when it visits an Anchor, it ensures
that a corresponding Category exists in the SiteIndex, and that a
corresponding Topic exists in the Category, before inserting a Link
into
the Topic. When all Pages have been generated, HTML pages for the
bibliography and index are generated from the BibliographyPage and
SiteIndexPage, respectively.<br>
<br style="font-weight: bold; font-style: italic;">
<span style="font-weight: bold; font-style: italic;">Exception Handling</span><br>
<br>
</span></small><small><span
 style="font-family: helvetica,arial,sans-serif;">Since exceptions are
not thrown by the BookElementVisitor interface, The
HTMLBookElementVisitor is given a user-supplied ErrorHandler to handle
any Exception that is thrown during model traversal.<br>
</span></small><br>
<br>
<table cellpadding="2" cellspacing="0" border="1"
 style="text-align: left; width: 100%;">
  <tbody>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 src="BookHTMLRenderer.gif" title="Renderer classes"
 alt="Renderer classes" style="width: 1044px; height: 878px;"><br>
      </td>
    </tr>
  </tbody>
</table>
<br style="font-family: helvetica,arial,sans-serif;">
<small><span style="font-family: helvetica,arial,sans-serif;"></span></small><font
 class="normalText"><a href="#Martin%20Fowler%27s%20Design%20Principles"></a><a><br>
<br>
</a> <a><br>
</a></font>
</body>
</html>
