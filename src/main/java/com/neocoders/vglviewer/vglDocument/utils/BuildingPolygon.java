/* Generated by Together */

package com.neocoders.vglviewer.vglDocument.utils;

import com.neocoders.vglviewer.vglDocument.VGLPolygon;
import com.neocoders.vglviewer.vglDocument.VGLPoints;
import com.neocoders.vglviewer.vglDocument.VGLProperties;
import com.neocoders.vglviewer.vglDocument.VGLStyle;
import com.neocoders.vglviewer.vglDocument.VGLPoint;
import java.util.Vector;
import java.util.Iterator;

class BuildingPolygon extends AbstractBuilderState {
    /** Initialise new state in which we are building a polygon */
    public BuildingPolygon(BuildContext context, AbstractBuilderState parent) {
        super(context, parent);
        this.style = context.getDefaultStyle();
        this.description = "none";
        this.id = context.getID();
        this.points = new Vector();
    }

    /** Add a vertex to polygon */
    public void addVertex(long x, long y) {
        points.add(new VGLPoint(x, y));
    }

    /** Apply a previously defined style to polygon */
    public void applyStyle(String styleName) {
        VGLStyle temp = context.getStyle(styleName);
        if (temp == null) {
            context.getErrorHandler().handleError("no style named '" + styleName + "' defined");
        }
        this.style = temp;
    }

    /** Build polygon, add it to document, return parent state */
    public AbstractBuilderState close() {
        long[] sx = new long[points.size()];
        long[] sy = new long[points.size()];
        Iterator iterator = points.iterator();
        int i = 0;
        while (iterator.hasNext()) {
            VGLPoint p = (VGLPoint)iterator.next();
            sx[i] = p.x;
            sy[i] = p.y;
            i++;
        }
        VGLPolygon element = new VGLPolygon(new VGLProperties(style, description, id), new VGLPoints(sx, sy));
        context.getDocument().addElement(element);
        return parent;
    }

    /** Get description of what we are building in this state */
    protected String getDescription() {
        return "a polygon";
    }

    private VGLStyle style;
    private String description;
    private String id;
    private Vector points;
}
